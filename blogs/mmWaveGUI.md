---
layout: page
permalink: /blogs/mmWaveGUI/index.html
title: æ¯«ç±³æ³¢é›·è¾¾æ–‡çŒ®ç»¼è¿°
---

## æ¯«ç±³æ³¢é›·è¾¾ä¸²å£é‡‡é›†å¹¶è§£ææ•°æ®GUI

--- 

### ğŸ”¥ å‰è¨€

>æ­¤æ•™ç¨‹é€‚ç”¨äºå•TIæ¯«ç±³æ³¢é›·è¾¾æ¿å¡ä¸²å£è¿”å›æ•°æ®å¹¶è§£æ,æœªæ·»åŠ DCA1000æ•°æ®é‡‡é›†æ¿å¡

<br>åœ¨ä½¿ç”¨TIçš„æ¯«ç±³æ³¢é›·è¾¾æ¿å¡æ—¶,TIå®˜æ–¹æä¾›äº†å¦‚**mmWave Studio**,**mmWave_Demo_Visualizer**ç­‰ä¸Šä½æœºè½¯ä»¶,ä»¥ä¾¿æ–°æ‰‹èƒ½åœ¨çŸ­æ—¶é—´å†…è¿è¡Œä¸€ä¸ªDEMOç¨‹åºå¯è§†åŒ–é›·è¾¾æ¿ç‚¹äº‘æ•°æ®å’Œè¿›è¡Œé›·è¾¾é…ç½®ã€‚

<br>è™½ç„¶TIå®˜æ–¹å’Œç½‘ä¸Šçš„æ•™ç¨‹éƒ½å¾ˆå®Œæ•´åœ°ç»™å‡ºäº†è§£æé›·è¾¾ç‰ˆ+DCAæ•°æ®é‡‡é›†æ¿çš„ADCæ•°æ®æ•™ç¨‹,å¯æ˜¯TIå®˜æ–¹æ˜ç¡®è¯´æ˜äº†å¹¶æ²¡æœ‰æä¾›å•é›·è¾¾ç‰ˆç‚¹äº‘æ•°æ®é‡‡é›†çš„æ•™ç¨‹,ç¬”è€…åœ¨ç½‘ç»œè®ºå›ä»¥åŠå’ŒåŒè¡Œä»¬äº¤æµçš„è¿‡ç¨‹ä¸­,å¤§å®¶ä¹Ÿå„è‡ªæœ‰è‡ªå·±å¼€å‘é‡‡é›†ä»£ç çš„æƒ³æ³•ã€‚

<br>å› æ­¤,åœ¨ç¬”è€…è¿›è¡Œå‡ å¤©çš„ä¸²å£æ•°æ®è§£æçš„æ¢ç´¢ä¹‹å,ç»ˆäºæˆåŠŸåœ°å®ç°äº†ç®€å•åœ°è‡ªå®šä¹‰é‡‡é›†å¸§ç‡,å¹¶å°†åŸå§‹æ•°æ®å’Œè§£ææˆåŠŸçš„æ•°æ®ä»¥binæ–‡ä»¶å’Œxlsxæ–‡ä»¶å‚¨å­˜çš„ä»£ç ã€‚

---

### ğŸ´ ä¸‹è½½æºç 

1. ä¸‹è½½TIå®˜æ–¹æä¾›çš„radar_toolboxå·¥å…·åŒ…,æ¥ä¸‹æ¥çš„æ­¥éª¤ä¼šä½¿ç”¨åˆ°å…¶ä¸­çš„pyæ–‡ä»¶,ä¸‹è½½åœ°å€å¯[ç‚¹å‡»è¿™é‡Œ](https://www.ti.com/tool/download/RADAR-TOOLBOX/1.30.01.03)

2. æ ¹æ®çš„è·¯å¾„:*radar_toolbox_1_30_01_03\tools\visualizers\Industrial_Visualizer*
   æ‰¾åˆ°*mmWave_Industrial_Visualizer.exe*è¿™ä¸ªä¸Šä½æœºè½¯ä»¶
   
<br> å…¶å®,åœ¨è¿™ä¸ªä¸Šä½æœºè½¯ä»¶ä¸­,é™¤äº†å¯è§†åŒ–ç‚¹äº‘å’Œè¿è¡ŒTIçš„DEMOä»¥å¤–,å·²ç»å¯ä»¥å®ç°ç®€å•åœ°ä¸²å£é‡‡é›†åŠŸèƒ½,å¤§å®¶ä¸å¦¨ä¸€è¯•ã€‚

<br> ä½†æ˜¯è¿™ä¸ªåŠŸèƒ½èŠèƒœäºæ— ğŸ˜‚,å› ä¸ºé‡‡é›†çš„æ•°æ®æ˜¯ä¸ä»…åŸå§‹çš„**äºŒè¿›åˆ¶æ•°æ®**,è¿˜ä¸èƒ½**è‡ªå®šä¹‰**é‡‡é›†æ–‡ä»¶çš„å¸§ç‡ï¼ˆé»˜è®¤ä¸º100å¸§é‡‡é›†ä¸ºä¸€ä¸ªbinæ–‡ä»¶,è€ŒTIé›·è¾¾ç‰ˆçš„ä¸²å£æ˜¯1ç§’10å¸§,é™¤éæ˜¯é™æ€ç‚¹äº‘çš„é¡¹ç›®,å¦åˆ™è¿™ä¸ªæ•°æ®é‡‡é›†ä¹‹åè¿˜éœ€è¦æ‰‹åŠ¨åˆ†å‰²ï¼‰

<br> åœ¨å°è¯•æ— æœä¹‹å,ç¬”è€…åœ¨é˜…è¯»è¿™ä¸ªæ–‡æ¡£çš„æ—¶å€™å‘ç°äº†æœ‰è¶£çš„ä¸œè¥¿[mmWave_Industrial_Visualizer_User_Guide.html](https://dev.ti.com/tirex/explore/node?node=A__AOFxUnA4gLo7lRDXedw8XQ__radar_toolbox__1AslXXD__LATEST)

```bash
.radar_toolbox_1_30_01_03\tools\visualizers\Industrial_Visualizer
â”œâ”€â”€ gui_main.py         the main program which controls placement of all items in the GUI and schedules UART read and graphing tasks.
â”œâ”€â”€ gui_parser.py       defines an object used for parsing the UART stream. If you want to parse the UART data, you can use this file to do so.
â”œâ”€â”€ gui_threads.py      defines the different threads that are run by the demo. These threads handle updating the plot and calling the UART parser.
â”œâ”€â”€ graphUtilities.py   contains functions used to draw objects.
â”œâ”€â”€ gui_common.py       aggregates several variables and configurables which are used across several files.
â”œâ”€â”€ parseFrame.py       is responsible for parsing the frame format of incoming data.
â””â”€â”€ parseTLVs.py        is responsible for parsing all TLVâ€™s which are defined in the demos.
```

<br> ğŸ’¡ ä¹Ÿå°±æ˜¯è¯´,ä¸Šä½æœºå¯ä»¥é€šè¿‡*parseFrame.py*å’Œ*parseTLVs.py*è¿™ä¸¤ä¸ªè„šæœ¬è¿›è¡ŒTLVSæ•°æ®è§£æ
<br> é€šè¿‡*gui_parser.py*å¯ä»¥å®ç°ä¸²å£æ•°æ®è§£æ

---

### ğŸ­ ä»£ç é€šè¯»

#### parseTLVs.py 

<br>è¿™ä¸ªæ–‡ä»¶ä¸»è¦æ˜¯ç”¨äºè§£æTLVsæ•°æ®,ç”¨äºå…¶ä»–è„šæœ¬è°ƒç”¨,è¿™é‡Œä¸å†èµ˜è¿°
<br>å€¼å¾—æ³¨æ„çš„æ˜¯,ä¸‹é¢çš„æ³¨é‡Šè¡¨æ˜äº†è§£æåçš„ç‚¹äº‘æ•°æ®æ ¼å¼ä¸º**x,y,z,Dopper,SNR,Noise**

````python
```
    # Parse each point
    numPoints = int((tlvLength-pUnitSize)/pointSize)
    for i in range(numPoints):
        try:
            x, y, z, doppler, snr, noise = struct.unpack(pointStruct, tlvData[:pointSize])
        except:
            numPoints = i
            print('Error: Point Cloud TLV Parser Failed')
            break
        
        tlvData = tlvData[pointSize:]
        # Decompress values
        pointCloud[i,0] = x * pUnit[0]          # x
        pointCloud[i,1] = y * pUnit[0]          # y
        pointCloud[i,2] = z * pUnit[0]          # z
        pointCloud[i,3] = doppler * pUnit[1]    # Dopper
        pointCloud[i,4] = snr * pUnit[2]        # SNR
        pointCloud[i,5] = noise * pUnit[3]      # Noise
    return numPoints, pointCloud
````

#### parseFrame.py 

<br>è¿™ä¸ªæ–‡ä»¶ç”¨äºè°ƒç”¨*def parseStandardFrame(frameData)*è¿›è¡Œæ•°æ®çš„è§£æ
<br>è¯»è€…å¯ä»**ä¸²å£**copyä¸€æ®µæ¯«ç±³æ³¢é›·è¾¾çš„**åŸå§‹æ•°æ®**æ”¾è¿›**txt**æ–‡ä»¶,å¯ä½¿ç”¨ç¬”è€…æä¾›çš„ä¾‹ç¨‹å°è¯•è§£ææ•°æ®:

````python
```
# @file        real_data
# @type        python
# @author      Kano
# @date        2024-03-18
#@brief        ç”¨äºè§£ææ¯«ç±³æ³¢é›·è¾¾çš„æ•°æ®
from gui_parser import *
import pandas as pd
import numpy as np

# å®šä¹‰è¾“å…¥æ–‡ä»¶å’Œè¾“å‡ºæ–‡ä»¶è·¯å¾„
input_file = 'originData.txt'
output_file = 'ProcessedData.xlsx'  # ä¿®æ”¹è¾“å‡ºæ–‡ä»¶ä¸ºxlsxæ ¼å¼
def parse_input_data(file_path):
    # è¯»å–è¾“å…¥æ–‡ä»¶çš„æ•°æ®
    with open(file_path, 'r') as file:
        data = file.read()
    # ç§»é™¤æ¢è¡Œç¬¦,å¹¶å°†æ•°æ®æ‹†åˆ†ä¸ºå¸§
    frames = data.split('\n')
    # è§£ææ¯ä¸ªå¸§çš„æ•°æ®
    parsed_data = []
    for frame in frames:
        if len(frame) > 0:
            # å°†å¸§æ•°æ®è½¬æ¢ä¸ºå­—èŠ‚æµ
            frame_data = bytes.fromhex(frame)
            # è°ƒç”¨è§£æå‡½æ•°è§£æå¸§æ•°æ®
            parsed_frame = parseStandardFrame(frame_data)
            # å°†è§£æç»“æœæ·»åŠ åˆ°åˆ—è¡¨ä¸­
            parsed_data.append(parsed_frame)
    return parsed_data

def extract_point_cloud(parsed_data):
    # æå–ç‚¹äº‘æ•°æ®
    point_cloud = []
    for frame in parsed_data:
        point_cloud.extend(frame['pointCloud'])
    return point_cloud

def write_output_data(file_path, point_cloud):
    # åˆ›å»ºDataFrameå¯¹è±¡
    df = pd.DataFrame(point_cloud, columns=['X', 'Y', 'Z', 'Doppler', 'SNR', 'Noise', 'Track index'])
    # å°†DataFrameå†™å…¥Excelæ–‡ä»¶
    df.to_excel(file_path, index=False)

# Press the green button in the gutter to run the script.
if __name__ == '__main__':
    # è§£æè¾“å…¥æ•°æ®
    parsed_data = parse_input_data(input_file)
    # æå–ç‚¹äº‘æ•°æ®
    point_cloud = extract_point_cloud(parsed_data)
    # å°†è§£æç»“æœå†™å…¥è¾“å‡ºæ–‡ä»¶
    write_output_data(output_file, point_cloud)
````

<br>è§£æåçš„ç‚¹äº‘æ ¼å¼åº”ä¸º:

<center>
<img src = "/blogs/mmWaveGUI.assets/pointCloudDatatxt.png" width="400" height="240">
</center>

<br>è‡³æ­¤,æˆ‘ä»¬ä¾¿å®Œæˆäº†ä¸€æ®µåŸå§‹æ•°æ®çš„è§£æã€‚é‚£ä¹ˆ,æˆ‘ä»¬å¦‚ä½•å®ç°ä¸²å£è¿”å›æ•°æ®çš„å®æ—¶è§£æå¹¶ä¿å­˜å‘¢

#### gui_parser.py 

<br>è¿™ä¸ªä»£ç ä¸ºå®˜æ–¹ä¸Šä½æœºæ‰€ä½¿ç”¨çš„ä¸²å£æ•°æ®è§£ææ–‡ä»¶,å¦‚æœè¯»è€…æœ‰å…´è¶£,ä¹Ÿå¯ä»¥æ ¹æ®è¿™ä¸ªä»£ç å®ç°è‡ªå·±çš„å®æ—¶ä¸Šä½æœºæ˜¾ç¤ºï¼ˆå¼€å‘æ—¶é—´ä¼šæœ‰ç‚¹é•¿ï¼‰

<br>è¿˜è®°å¾—ä¸Šé¢è¯´çš„:

> åœ¨è¿™ä¸ªä¸Šä½æœºè½¯ä»¶ä¸­,é™¤äº†å¯è§†åŒ–ç‚¹äº‘å’Œè¿è¡ŒTIçš„DEMOä»¥å¤–,å·²ç»å¯ä»¥å®ç°ç®€å•åœ°ä¸²å£é‡‡é›†åŠŸèƒ½

<br>ä¹Ÿå°±æ˜¯è¯´,åªè¦æˆ‘ä»¬èƒ½å¤Ÿç†è§£æ­¤æ–‡ä»¶ä¸­çš„å‚æ•°è®¾ç½®å¹¶å°è¯•æ•è·è§£æåçš„æ•°æ®,æˆ‘ä»¬ä¾¿å¯ä»¥å®ç°åœ¨ä½¿ç”¨TIä¸Šä½æœºçš„åŒæ—¶,ä¿®æ”¹å®ƒçš„åŠŸèƒ½,è‡ªå®šä¹‰**é‡‡é›†å¸§ç‡,æ•°æ®æ ¼å¼,æ¯æ–‡ä»¶å¸§æ•°,ä»¥åŠæ–‡ä»¶æ ¼å¼**

<br>ç›´å…¥æ­£é¢˜,ç”±äºç¬”è€…æ‰€ä½¿ç”¨çš„çš„é›·è¾¾ç‰ˆå‹å·ä¸º**IWR1843**,æ‰€å¯¹åº”ä¸Šä½æœºä¸²å£å¤„ç†å‡½æ•°ä¸º
<br>*def readAndParseUartDoubleCOMPort(self)*,å„ä½æ ¹æ®è‡ªå·±çš„é›·è¾¾ç‰ˆå¯¹åº”å‡½æ•°ä¿®æ”¹å³å¯

<br>å…¶ä¸­,ä¿å­˜**äºŒè¿›åˆ¶**æ–‡ä»¶çš„ä»£ç æ®µä¸º:

````python
```
# If save binary is enabled
    if(self.saveBinary == 1):
        self.binData += frameData
        # Save data every framesPerFile frames
        self.uartCounter += 1
        if (self.uartCounter % self.framesPerFile == 0):
            # First file requires the path to be set up
            if(self.first_file is True): 
                if(os.path.exists('binData/') == False):
                    # Note that this will create the folder in the caller's path, not necessarily in the Industrial Viz Folder                        
                    os.mkdir('binData/')
                os.mkdir('binData/'+self.filepath)
                self.first_file = False
            toSave = bytes(self.binData)
            fileName = 'binData/' + self.filepath + '/pHistBytes_' + str(math.floor(self.uartCounter/self.framesPerFile)) + '.bin'
            bfile = open(fileName, 'wb')
            bfile.write(toSave)
            bfile.close()
            # Reset binData and missed frames
            self.binData = []
    # frameData now contains an entire frame, send it to parser
    if (self.parserType == "DoubleCOMPort"):
        outputDict = parseStandardFrame(frameData)
    else:
        print ('FAILURE: Bad parserType')
        
    return outputDict
````

ç”¨GPTè§£æä¸€ä¸‹è¯¥ä»£ç é€»è¾‘

````python
```
è¿™æ®µä»£ç å¤„ç†äº†æ¥æ”¶åˆ°çš„æ•°æ®å¸§(frameData)å’Œä¿å­˜äºŒè¿›åˆ¶æ•°æ®çš„é€»è¾‘.ä¸‹é¢æ˜¯å¯¹ä»£ç é€»è¾‘çš„è§£é‡Š:
1. å¦‚æœå¯ç”¨äº†ä¿å­˜äºŒè¿›åˆ¶æ•°æ®çš„é€‰é¡¹(self.saveBinary == 1),åˆ™æ‰§è¡Œä»¥ä¸‹æ“ä½œ:
    å°†å½“å‰æ¥æ”¶åˆ°çš„æ•°æ®å¸§(frameData)æ·»åŠ åˆ°binDataä¸­
    æ¯æ¥æ”¶åˆ°framesPerFileå¸§æ•°æ®æ—¶,ä¿å­˜ä¸€æ¬¡æ•°æ®ã€‚
    uartCounteré€’å¢1,ç”¨äºè®¡ç®—æ¥æ”¶åˆ°çš„å¸§æ•°
    å¦‚æœuartCounteræ˜¯framesPerFileçš„å€æ•°,è¯´æ˜éœ€è¦ä¿å­˜æ•°æ®åˆ°æ–‡ä»¶ã€‚
    ç¬¬ä¸€æ¬¡ä¿å­˜æ—¶éœ€è¦è®¾ç½®è·¯å¾„:
        å¦‚æœfirst_fileä¸ºTrue,å³ç¬¬ä¸€ä¸ªæ–‡ä»¶,æ£€æŸ¥æ˜¯å¦å­˜åœ¨binData/æ–‡ä»¶å¤¹,å¦‚æœä¸å­˜åœ¨,åˆ™åˆ›å»ºè¯¥æ–‡ä»¶å¤¹
        åœ¨binData/æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºself.filepathæ–‡ä»¶å¤¹
        å°†first_fileè®¾ç½®ä¸ºFalse,è¡¨ç¤ºå·²ç»è®¾ç½®è¿‡è·¯å¾„
    å°†binDataè½¬æ¢ä¸ºå­—èŠ‚æµ(toSave)
    æ ¹æ®å½“å‰ä¿å­˜çš„æ–‡ä»¶ç¼–å·(math.floor(self.uartCounter/self.framesPerFile))æ„é€ æ–‡ä»¶å(fileName)
    æ‰“å¼€æ–‡ä»¶(bfile)å¹¶å°†å­—èŠ‚æµå†™å…¥æ–‡ä»¶
    å…³é—­æ–‡ä»¶(bfile)
    é‡ç½®binData,å‡†å¤‡ä¿å­˜ä¸‹ä¸€æ‰¹æ•°æ®
2.å¦‚æœparserTypeæ˜¯"DoubleCOMPort",åˆ™è°ƒç”¨parseStandardFrameå‡½æ•°è§£ææ¥æ”¶åˆ°çš„æ•°æ®å¸§(frameData),å¹¶å°†è§£æç»“æœå­˜å‚¨åœ¨outputDictä¸­
3.å¦‚æœparserTypeä¸æ˜¯"DoubleCOMPort",åˆ™æ‰“å°é”™è¯¯ä¿¡æ¯"FAILURE: Bad parserType"
4.è¿”å›outputDictä½œä¸ºç»“æœ
æ€»ä½“ä¸Š,è¿™æ®µä»£ç å®ç°äº†å°†æ¥æ”¶åˆ°çš„æ•°æ®å¸§ä¿å­˜ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶,å¹¶è°ƒç”¨ç›¸åº”çš„è§£æå™¨å¯¹æ•°æ®è¿›è¡Œè§£æ.è§£æçš„ç»“æœå­˜å‚¨åœ¨outputDictä¸­,å¹¶ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼
````

<br>ä¹Ÿå°±æ˜¯,å¯ä»¥æˆªå–*outputDict*è¿™ä¸ªè¾“å‡ºç»“æœ,ä»¿ç…§è¯¥ä»£ç æ®µä¸­binæ–‡ä»¶ä¿å­˜çš„å½¢å¼,è¿›è¡Œxlsx,txtç­‰ç­‰è¯»è€…è‡ªå·±å–œæ¬¢çš„æ–¹å¼ä¿å­˜æ–‡ä»¶ï¼

<br>è€Œ*parseStandardFrame(frameData)*è¿™ä¸ªå‡½æ•°è¿”å›çš„å€¼ä¸ºä¸€ä¸ªå­—å…¸,åŒ…å«ç‚¹äº‘æ•°,å¸§æ•°,ç‚¹äº‘æ•°æ®ç­‰å†…å®¹,æˆ‘ä»¬åªéœ€é€šè¿‡**ä¸Šæ–‡æ‰€æä¾›ä¾‹ç¨‹**çš„åŒæ ·æ–¹æ³•æå–ç‚¹äº‘æ•°æ®

<br>å¹¶ä¸”,å¯åœ¨å‡½æ•°å¼€å¤´ä¿®æ”¹*self.framesPerFile* è¿™ä¸ªå‚æ•°å®ç°è‡ªå®šä¹‰é‡‡é›†å¸§ç‡çš„ä»£ç å•¦

> è¯·æ³¨æ„,ä¿®æ”¹åçš„ä¸Šä½æœºåº”è¯¥ç»è¿‡é‡æ–°ç¼–è¯‘ä¸Šä½æœºä¸»å‡½æ•°*gui_main.py*,pythonç¯å¢ƒè¯·è‡ªè¡Œé…ç½®

### ğŸ“‰ é‡‡é›†ç»“æœ

<br>è‡³æ­¤,æˆ‘ä»¬ä¾¿å®Œæˆäº†è‡ªå®šä¹‰å¸§ç‡çš„ä¸²å£æ•°æ®è§£æå’Œé‡‡é›†å•¦ï¼æ ¹æ®ç¬”è€…æä¾›çš„ä¾‹ç¨‹é€»è¾‘,è§£æåçš„æ•°æ®å¦‚ä¸‹æ‰€ç¤º:

<center>
<img src = "/blogs/mmWaveGUI.assets/pointCloudDataxlsx.png" width="400" height="240">
</center>

<br>æ­¤æ•™ç¨‹æ—¨åœ¨è®²è§£å¦‚ä½•ä¿®æ”¹TIä¸Šä½æœº,è¯»è€…å¯æ ¹æ®è‡ªå·±çš„é¡¹ç›®éœ€æ±‚è‡ªè¡Œè°ƒæ•´

<br>åç»­ä¼šå°†ä¿®æ”¹åçš„å…·ä½“ä»£ç æ”¾åˆ°è¿™ä¸ªgithubä»“åº“ä¸­(ç›®å‰ä»…æä¾›ç¬”è€…æ‰€ç”¨çš„è°ƒè¯•ä¾‹ç¨‹)

### ğŸ ç»“è¯­

æœ€åçš„æœ€å,æ„Ÿè°¢ä½ é˜…è¯»è¿™ä»½æ–‡å­—ã€‚å¦‚æœç¬”è€…çš„åšå®¢æˆåŠŸå¸®åŠ©ä½ å®ç°äº†ä¸²å£æ•°æ®çš„è§£æå’Œé‡‡é›†,è¿˜è¯·ä½ ç»™æœ¬ä»“åº“çš„å³ä¸Šè§’ç‚¹ä¸€ä¸ª**star**â¤ï¸

ä¸æ­¤åŒæ—¶,å¦‚æœä½ æœ‰ä»»ä½•çš„å»ºè®®/æ„è§ï¼š

- æ¬¢è¿ä½ åœ¨Github Issuesä¸­æå‡ºæ„è§,å¹¶é™„ä¸Šå»ºè®®æ–¹æ¡ˆ
- æˆ–è€…åœ¨Github Discussionsè¿›è¡Œè°ˆè®º,æ¬¢è¿ä½ æå‡ºä»»ä½•çœ‹æ³•
- è”ç³»æˆ‘çš„QQ:3065566278 
- ä¸€èµ·äº¤æµæ¯«ç±³æ³¢é›·è¾¾é¡¹ç›®å§ğŸ˜¸~

