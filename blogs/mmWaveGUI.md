---
layout: page
permalink: /blogs/mmWaveGUI/index.html
title: æ¯«ç±³æ³¢é›·è¾¾æ–‡çŒ®ç»¼è¿°
---

## æ¯«ç±³æ³¢é›·è¾¾ä¸²å£é‡‡é›†å¹¶è§£ææ•°æ®GUI

--- 

### ğŸ”¥ å‰è¨€

>æ­¤æ•™ç¨‹é€‚ç”¨äºå•TIæ¯«ç±³æ³¢é›·è¾¾æ¿å¡ä¸²å£è¿”å›æ•°æ®å¹¶è§£æ,æœªæ·»åŠ DCA1000æ•°æ®é‡‡é›†æ¿å¡

<br>åœ¨ä½¿ç”¨TIçš„æ¯«ç±³æ³¢é›·è¾¾æ¿å¡æ—¶,TIå®˜æ–¹æä¾›äº†å¦‚**mmWave Studio**,**mmWave_Demo_Visualizer**ç­‰ä¸Šä½æœºè½¯ä»¶,ä»¥ä¾¿æ–°æ‰‹èƒ½åœ¨çŸ­æ—¶é—´å†…è¿è¡Œä¸€ä¸ªDEMOç¨‹åºå¯è§†åŒ–é›·è¾¾æ¿ç‚¹äº‘æ•°æ®å’Œè¿›è¡Œé›·è¾¾é…ç½®ã€‚

<br>è™½ç„¶TIå®˜æ–¹å’Œç½‘ä¸Šçš„æ•™ç¨‹éƒ½å¾ˆå®Œæ•´åœ°ç»™å‡ºäº†è§£æé›·è¾¾ç‰ˆ+DCAæ•°æ®é‡‡é›†æ¿çš„ADCæ•°æ®æ•™ç¨‹,å¯æ˜¯TIå®˜æ–¹æ˜ç¡®è¯´æ˜äº†å¹¶æ²¡æœ‰æä¾›å•é›·è¾¾ç‰ˆç‚¹äº‘æ•°æ®é‡‡é›†çš„æ•™ç¨‹,ç¬”è€…åœ¨ç½‘ç»œè®ºå›ä»¥åŠå’ŒåŒè¡Œä»¬äº¤æµçš„è¿‡ç¨‹ä¸­,å¤§å®¶ä¹Ÿå„è‡ªæœ‰è‡ªå·±å¼€å‘é‡‡é›†ä»£ç çš„æƒ³æ³•ã€‚

<br>å› æ­¤,åœ¨ç¬”è€…è¿›è¡Œå‡ å¤©çš„ä¸²å£æ•°æ®è§£æçš„æ¢ç´¢ä¹‹å,ç»ˆäºæˆåŠŸåœ°å®ç°äº†ç®€å•åœ°è‡ªå®šä¹‰é‡‡é›†å¸§ç‡,å¹¶å°†åŸå§‹æ•°æ®å’Œè§£ææˆåŠŸçš„æ•°æ®ä»¥binæ–‡ä»¶å’Œxlsxæ–‡ä»¶å‚¨å­˜çš„ä»£ç ã€‚
---

### ğŸ´ ä¸‹è½½æºç 

1. ä¸‹è½½TIå®˜æ–¹æä¾›çš„radar_toolboxå·¥å…·åŒ…ï¼Œæ¥ä¸‹æ¥çš„æ­¥éª¤ä¼šä½¿ç”¨åˆ°å…¶ä¸­çš„pyæ–‡ä»¶ï¼Œä¸‹è½½åœ°å€å¯ç‚¹å‡»è¿™é‡Œ

2. æ ¹æ®ä¸‹é¢çš„è·¯å¾„æ‰¾åˆ°éœ€è¦çš„ä¸Šä½æœºè½¯ä»¶:*radar_toolbox_1_30_01_03\tools\visualizers\Industrial_Visualizer*æ‰¾åˆ°*mmWave_Industrial_Visualizer.exe*
   
<br> å…¶å®ï¼Œåœ¨è¿™ä¸ªä¸Šä½æœºè½¯ä»¶ä¸­ï¼Œé™¤äº†å¯è§†åŒ–ç‚¹äº‘å’Œè¿è¡ŒTIçš„DEMOä»¥å¤–,å·²ç»å¯ä»¥å®ç°ç®€å•åœ°ä¸²å£é‡‡é›†åŠŸèƒ½ï¼Œå¤§å®¶ä¸å¦¨ä¸€è¯•ã€‚

<br> ä½†æ˜¯è¿™ä¸ªåŠŸèƒ½èŠèƒœäºæ— ğŸ˜‚ï¼Œå› ä¸ºé‡‡é›†çš„æ•°æ®æ˜¯ä¸ä»…åŸå§‹çš„**äºŒè¿›åˆ¶æ•°æ®**ï¼Œè¿˜ä¸èƒ½**è‡ªå®šä¹‰**é‡‡é›†æ–‡ä»¶çš„å¸§ç‡ï¼ˆé»˜è®¤ä¸º100å¸§é‡‡é›†ä¸ºä¸€ä¸ªbinæ–‡ä»¶ï¼Œè€ŒTIé›·è¾¾ç‰ˆçš„ä¸²å£æ˜¯1ç§’10å¸§ï¼Œé™¤éæ˜¯é™æ€ç‚¹äº‘çš„é¡¹ç›®ï¼Œå¦åˆ™è¿™ä¸ªæ•°æ®é‡‡é›†ä¹‹åè¿˜éœ€è¦æ‰‹åŠ¨åˆ†å‰²ï¼‰

<br> åœ¨å°è¯•æ— æœä¹‹åï¼Œç¬”è€…åœ¨é˜…è¯»è¿™ä¸ªæ–‡æ¡£çš„æ—¶å€™å‘ç°äº†æœ‰è¶£çš„ä¸œè¥¿*mmWave_Industrial_Visualizer_User_Guide.html*

```bash
.radar_toolbox_1_30_01_03\tools\visualizers\Industrial_Visualizer
â”œâ”€â”€ gui_main.py         the main program which controls placement of all items in the GUI and schedules UART read and graphing tasks.
â”œâ”€â”€ gui_parser.py       defines an object used for parsing the UART stream. If you want to parse the UART data, you can use this file to do so.
â”œâ”€â”€ gui_threads.py      defines the different threads that are run by the demo. These threads handle updating the plot and calling the UART parser.
â”œâ”€â”€ graphUtilities.py   contains functions used to draw objects.
â”œâ”€â”€ gui_common.py       aggregates several variables and configurables which are used across several files.
â”œâ”€â”€ parseFrame.py       is responsible for parsing the frame format of incoming data.
â””â”€â”€ parseTLVs.py        is responsible for parsing all TLVâ€™s which are defined in the demos.
```

<br> ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šä½æœºå¯ä»¥é€šè¿‡*parseFrame.py*å’Œ*parseTLVs.py*è¿™ä¸¤ä¸ªè„šæœ¬è¿›è¡ŒTLVSæ•°æ®è§£æ
<br> é€šè¿‡*gui_parser.py*å¯ä»¥å®ç°ä¸²å£æ•°æ®è§£æ

---

### ğŸ­ ä»£ç é€šè¯»

#### parseTLVs.py 

<br>è¿™ä¸ªæ–‡ä»¶ä¸»è¦æ˜¯ç”¨äºè§£æTLVsæ•°æ®ï¼Œç”¨äºå…¶ä»–è„šæœ¬è°ƒç”¨ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚
<br>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸‹é¢çš„æ³¨é‡Šè¡¨æ˜äº†è§£æåçš„ç‚¹äº‘æ•°æ®æ ¼å¼ä¸º**xï¼Œyï¼Œzï¼ŒDopperï¼ŒSNRï¼ŒNoise**

````python
```
    # Parse each point
    numPoints = int((tlvLength-pUnitSize)/pointSize)
    for i in range(numPoints):
        try:
            x, y, z, doppler, snr, noise = struct.unpack(pointStruct, tlvData[:pointSize])
        except:
            numPoints = i
            print('Error: Point Cloud TLV Parser Failed')
            break
        
        tlvData = tlvData[pointSize:]
        # Decompress values
        pointCloud[i,0] = x * pUnit[0]          # x
        pointCloud[i,1] = y * pUnit[0]          # y
        pointCloud[i,2] = z * pUnit[0]          # z
        pointCloud[i,3] = doppler * pUnit[1]    # Dopper
        pointCloud[i,4] = snr * pUnit[2]        # SNR
        pointCloud[i,5] = noise * pUnit[3]      # Noise
    return numPoints, pointCloud
````

#### parseFrame.py 

<br>è¿™ä¸ªæ–‡ä»¶ç”¨äºè°ƒç”¨*def parseStandardFrame(frameData)*è¿›è¡Œæ•°æ®çš„è§£æ
<br>è¯»è€…å¯ç›´æ¥ä»ä¸²å£copyä¸€æ®µæ¯«ç±³æ³¢é›·è¾¾çš„æ•°æ®æ”¾è¿›txtæ–‡ä»¶ï¼Œå¯ä½¿ç”¨ç¬”è€…æä¾›çš„ä¾‹ç¨‹å°è¯•è§£ææ•°æ®

````python
```
# @file        real_data
# @type        python
# @author      Kano
# @date        2024-03-18
#@brief        ç”¨äºè§£ææ¯«ç±³æ³¢é›·è¾¾çš„æ•°æ®
from gui_parser import *
import pandas as pd
import numpy as np

# å®šä¹‰è¾“å…¥æ–‡ä»¶å’Œè¾“å‡ºæ–‡ä»¶è·¯å¾„
input_file = 'originData.txt'
output_file = 'ProcessedData.xlsx'  # ä¿®æ”¹è¾“å‡ºæ–‡ä»¶ä¸ºxlsxæ ¼å¼
def parse_input_data(file_path):
    # è¯»å–è¾“å…¥æ–‡ä»¶çš„æ•°æ®
    with open(file_path, 'r') as file:
        data = file.read()
    # ç§»é™¤æ¢è¡Œç¬¦ï¼Œå¹¶å°†æ•°æ®æ‹†åˆ†ä¸ºå¸§
    frames = data.split('\n')
    # è§£ææ¯ä¸ªå¸§çš„æ•°æ®
    parsed_data = []
    for frame in frames:
        if len(frame) > 0:
            # å°†å¸§æ•°æ®è½¬æ¢ä¸ºå­—èŠ‚æµ
            frame_data = bytes.fromhex(frame)
            # è°ƒç”¨è§£æå‡½æ•°è§£æå¸§æ•°æ®
            parsed_frame = parseStandardFrame(frame_data)
            # å°†è§£æç»“æœæ·»åŠ åˆ°åˆ—è¡¨ä¸­
            parsed_data.append(parsed_frame)
    return parsed_data

def extract_point_cloud(parsed_data):
    # æå–ç‚¹äº‘æ•°æ®
    point_cloud = []
    for frame in parsed_data:
        point_cloud.extend(frame['pointCloud'])
    return point_cloud

def write_output_data(file_path, point_cloud):
    # åˆ›å»ºDataFrameå¯¹è±¡
    df = pd.DataFrame(point_cloud, columns=['X', 'Y', 'Z', 'Doppler', 'SNR', 'Noise', 'Track index'])
    # å°†DataFrameå†™å…¥Excelæ–‡ä»¶
    df.to_excel(file_path, index=False)

# Press the green button in the gutter to run the script.
if __name__ == '__main__':
    # è§£æè¾“å…¥æ•°æ®
    parsed_data = parse_input_data(input_file)

    # æå–ç‚¹äº‘æ•°æ®
    point_cloud = extract_point_cloud(parsed_data)

    # å°†è§£æç»“æœå†™å…¥è¾“å‡ºæ–‡ä»¶
    write_output_data(output_file, point_cloud)
````

<br>è§£æåçš„è¿”å›å¯¹è±¡åº”ä¸ºï¼š

<br>è§£æåçš„ç‚¹äº‘æ ¼å¼åº”ä¸ºï¼š

<br>è‡³æ­¤ï¼Œæˆ‘ä»¬ä¾¿å®Œæˆäº†ä¸€æ®µåŸå§‹æ•°æ®çš„è§£æã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•å®ç°ä¸²å£è¿”å›æ•°æ®çš„å®æ—¶è§£æå¹¶ä¿å­˜å‘¢

#### parseFrame.py 

<br>è¿™ä¸ªä»£ç ä¸ºå®˜æ–¹ä¸Šä½æœºæ‰€ä½¿ç”¨çš„ä¸²å£æ•°æ®è§£ææ–‡ä»¶ï¼Œå¦‚æœè¯»è€…æœ‰å…´è¶£ï¼Œä¹Ÿå¯ä»¥æ ¹æ®è¿™ä¸ªä»£ç å®ç°è‡ªå·±çš„å®æ—¶ä¸Šä½æœºæ˜¾ç¤ºï¼ˆå¼€å‘æ—¶é—´ä¼šæœ‰ç‚¹é•¿ï¼‰

<br>è¿˜è®°å¾—ä¸Šé¢è¯´çš„:

>> åœ¨è¿™ä¸ªä¸Šä½æœºè½¯ä»¶ä¸­ï¼Œé™¤äº†å¯è§†åŒ–ç‚¹äº‘å’Œè¿è¡ŒTIçš„DEMOä»¥å¤–,å·²ç»å¯ä»¥å®ç°ç®€å•åœ°ä¸²å£é‡‡é›†åŠŸèƒ½

<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æˆ‘ä»¬èƒ½å¤Ÿç†è§£æ­¤æ–‡ä»¶ä¸­çš„å‚æ•°è®¾ç½®å¹¶å°è¯•æ•è·è§£æåçš„æ•°æ®ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥å®ç°åœ¨ä½¿ç”¨TIä¸Šä½æœºçš„åŒæ—¶ï¼Œä¿®æ”¹å®ƒçš„åŠŸèƒ½ï¼Œè‡ªå®šä¹‰**é‡‡é›†å¸§ç‡ï¼Œæ•°æ®æ ¼å¼ï¼Œæ¯æ–‡ä»¶å¸§æ•°ï¼Œä»¥åŠæ–‡ä»¶æ ¼å¼**

<br>ç›´å…¥æ­£é¢˜ï¼Œç”±äºç¬”è€…æ‰€ä½¿ç”¨çš„çš„é›·è¾¾ç‰ˆå‹å·ä¸ºIWR1843ï¼Œæ‰€å¯¹åº”ä¸Šä½æœºä¸²å£å¤„ç†å‡½æ•°ä¸º*def readAndParseUartDoubleCOMPort(self)*ï¼Œå„ä½æ ¹æ®è‡ªå·±çš„é›·è¾¾ç‰ˆå¯¹åº”å‡½æ•°ä¿®æ”¹å³å¯

<br>å…¶ä¸­ï¼Œä¿å­˜äºŒè¿›åˆ¶æ–‡ä»¶çš„ä»£ç æ®µä¸ºï¼š

````python
```
# If save binary is enabled
    if(self.saveBinary == 1):
        self.binData += frameData
        # Save data every framesPerFile frames
        self.uartCounter += 1
        if (self.uartCounter % self.framesPerFile == 0):
            # First file requires the path to be set up
            if(self.first_file is True): 
                if(os.path.exists('binData/') == False):
                    # Note that this will create the folder in the caller's path, not necessarily in the Industrial Viz Folder                        
                    os.mkdir('binData/')
                os.mkdir('binData/'+self.filepath)
                self.first_file = False
            toSave = bytes(self.binData)
            fileName = 'binData/' + self.filepath + '/pHistBytes_' + str(math.floor(self.uartCounter/self.framesPerFile)) + '.bin'
            bfile = open(fileName, 'wb')
            bfile.write(toSave)
            bfile.close()
            # Reset binData and missed frames
            self.binData = []
    # frameData now contains an entire frame, send it to parser
    if (self.parserType == "DoubleCOMPort"):
        outputDict = parseStandardFrame(frameData)
    else:
        print ('FAILURE: Bad parserType')
        
    return outputDict
````

ç”¨GPTè§£æä¸€ä¸‹è¯¥ä»£ç é€»è¾‘

````python
```
è¿™æ®µä»£ç å¤„ç†äº†æ¥æ”¶åˆ°çš„æ•°æ®å¸§ï¼ˆframeDataï¼‰å’Œä¿å­˜äºŒè¿›åˆ¶æ•°æ®çš„é€»è¾‘ã€‚ä¸‹é¢æ˜¯å¯¹ä»£ç é€»è¾‘çš„è§£é‡Šï¼š
1. å¦‚æœå¯ç”¨äº†ä¿å­˜äºŒè¿›åˆ¶æ•°æ®çš„é€‰é¡¹ï¼ˆself.saveBinary == 1ï¼‰ï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
    å°†å½“å‰æ¥æ”¶åˆ°çš„æ•°æ®å¸§ï¼ˆframeDataï¼‰æ·»åŠ åˆ°binDataä¸­ã€‚
    æ¯æ¥æ”¶åˆ°framesPerFileå¸§æ•°æ®æ—¶ï¼Œä¿å­˜ä¸€æ¬¡æ•°æ®ã€‚
    uartCounteré€’å¢1ï¼Œç”¨äºè®¡ç®—æ¥æ”¶åˆ°çš„å¸§æ•°ã€‚
    å¦‚æœuartCounteræ˜¯framesPerFileçš„å€æ•°ï¼Œè¯´æ˜éœ€è¦ä¿å­˜æ•°æ®åˆ°æ–‡ä»¶ã€‚
    ç¬¬ä¸€æ¬¡ä¿å­˜æ—¶éœ€è¦è®¾ç½®è·¯å¾„ï¼š
        å¦‚æœfirst_fileä¸ºTrueï¼Œå³ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨binData/æ–‡ä»¶å¤¹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¯¥æ–‡ä»¶å¤¹ã€‚
        åœ¨binData/æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºself.filepathæ–‡ä»¶å¤¹ã€‚
        å°†first_fileè®¾ç½®ä¸ºFalseï¼Œè¡¨ç¤ºå·²ç»è®¾ç½®è¿‡è·¯å¾„ã€‚
    å°†binDataè½¬æ¢ä¸ºå­—èŠ‚æµï¼ˆtoSaveï¼‰ã€‚
    æ ¹æ®å½“å‰ä¿å­˜çš„æ–‡ä»¶ç¼–å·ï¼ˆmath.floor(self.uartCounter/self.framesPerFile)ï¼‰æ„é€ æ–‡ä»¶åï¼ˆfileNameï¼‰ã€‚
    æ‰“å¼€æ–‡ä»¶ï¼ˆbfileï¼‰å¹¶å°†å­—èŠ‚æµå†™å…¥æ–‡ä»¶ã€‚
    å…³é—­æ–‡ä»¶ï¼ˆbfileï¼‰ã€‚
    é‡ç½®binDataï¼Œå‡†å¤‡ä¿å­˜ä¸‹ä¸€æ‰¹æ•°æ®ã€‚
2.å¦‚æœparserTypeæ˜¯"DoubleCOMPort"ï¼Œåˆ™è°ƒç”¨parseStandardFrameå‡½æ•°è§£ææ¥æ”¶åˆ°çš„æ•°æ®å¸§ï¼ˆframeDataï¼‰ï¼Œå¹¶å°†è§£æç»“æœå­˜å‚¨åœ¨outputDictä¸­ã€‚
3.å¦‚æœparserTypeä¸æ˜¯"DoubleCOMPort"ï¼Œåˆ™æ‰“å°é”™è¯¯ä¿¡æ¯"FAILURE: Bad parserType"ã€‚
4.è¿”å›outputDictä½œä¸ºç»“æœã€‚
æ€»ä½“ä¸Šï¼Œè¿™æ®µä»£ç å®ç°äº†å°†æ¥æ”¶åˆ°çš„æ•°æ®å¸§ä¿å­˜ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„è§£æå™¨å¯¹æ•°æ®è¿›è¡Œè§£æã€‚è§£æçš„ç»“æœå­˜å‚¨åœ¨outputDictä¸­ï¼Œå¹¶ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ã€‚
````

ä¹Ÿå°±æ˜¯ï¼Œå¯ä»¥æˆªå–*outputDict*è¿™ä¸ªæˆªå–ç»“æœï¼Œä»¿ç…§è¯¥ä»£ç æ®µä¸­binæ–‡ä»¶ä¿å­˜çš„å½¢å¼ï¼Œè¿›è¡Œxlsxï¼Œtxtç­‰ç­‰è¯»è€…è‡ªå·±å–œæ¬¢çš„æ–¹å¼ä¿å­˜æ–‡ä»¶ï¼
è€Œ*parseStandardFrame(frameData)*è¿™ä¸ªå‡½æ•°è¿”å›çš„å€¼ä¸ºä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«ç‚¹äº‘æ•°ï¼Œå¸§æ•°ï¼Œç‚¹äº‘æ•°æ®ç­‰å†…å®¹ï¼Œæˆ‘ä»¬åªéœ€é€šè¿‡ä¸Šæ–‡æ‰€æä¾›ä¾‹ç¨‹çš„åŒæ ·æ–¹æ³•æå–ç‚¹äº‘æ•°æ®


å¹¶ä¸”ï¼Œå¯åœ¨å‡½æ•°å¼€å¤´ä¿®æ”¹*self.framesPerFile* è¿™ä¸ªå‚æ•°å®ç°è‡ªå®šä¹‰é‡‡é›†å¸§ç‡çš„ä»£ç å•¦

> è¯·æ³¨æ„ï¼Œä¿®æ”¹åçš„ä¸Šä½æœºåº”è¯¥ç»è¿‡é‡æ–°ç¼–è¯‘*gui_main.py*çš„ä¸Šä½æœºä¸»å‡½æ•°ï¼Œpythonç¯å¢ƒè¯·è‡ªè¡Œé…ç½®

### ğŸ“‰ é‡‡é›†ç»“æœ

è‡³æ­¤ï¼Œæˆ‘ä»¬ä¾¿å®Œæˆäº†è‡ªå®šä¹‰å¸§ç‡çš„ä¸²å£æ•°æ®è§£æå’Œé‡‡é›†å•¦

åç»­ä¼šå°†ä¿®æ”¹åçš„å…·ä½“ä»£ç æ”¾åˆ°è¿™ä¸ªgithubä»“åº“ä¸­ï¼š

æœ‰éœ€è¦çš„å°ä¼™ä¼´

